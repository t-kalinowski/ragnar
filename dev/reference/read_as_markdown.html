<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert files to markdown — read_as_markdown • ragnar</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert files to markdown — read_as_markdown"><meta name="description" content="Convert files to markdown"><meta property="og:description" content="Convert files to markdown"><meta property="og:image" content="https://ragnar.tidyverse.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="ragnar.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ragnar</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ragnar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/ragnar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Convert files to markdown</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/ragnar/blob/main/R/read-markdown.R" class="external-link"><code>R/read-markdown.R</code></a></small>
      <div class="d-none name"><code>read_as_markdown.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Convert files to markdown</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_as_markdown</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  canonical <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  html_extract_selectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"main"</span><span class="op">)</span>,</span>
<span>  html_zap_selectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nav"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A filepath or URL. Accepts a wide variety of file types, including
PDF, PowerPoint, Word, Excel, images (EXIF metadata and OCR), audio (EXIF
metadata and speech transcription), HTML, text-based formats (CSV, JSON,
XML), ZIP files (iterates over contents), YouTube URLs, and EPUBs.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Passed on to <code>MarkItDown.convert()</code>.</p></dd>


<dt id="arg-canonical">canonical<a class="anchor" aria-label="anchor" href="#arg-canonical"></a></dt>
<dd><p>Logical. Whether to postprocess the output from MarkItDown
with <code><a href="https://docs.ropensci.org/commonmark/reference/commonmark.html" class="external-link">commonmark::markdown_commonmark()</a></code>.</p></dd>


<dt id="arg-html-extract-selectors">html_extract_selectors<a class="anchor" aria-label="anchor" href="#arg-html-extract-selectors"></a></dt>
<dd><p>Character vector of CSS selectors. If a match
for a selector is found in the document, only the matched node's contents
are converted. Unmatched extract selectors have no effect.</p></dd>


<dt id="arg-html-zap-selectors">html_zap_selectors<a class="anchor" aria-label="anchor" href="#arg-html-zap-selectors"></a></dt>
<dd><p>Character vector of CSS selectors. Elements
matching these selectors will be excluded ("zapped") from the HTML document
before conversion to markdown. This is useful for removing navigation bars,
sidebars, headers, footers, or other unwanted elements. By default,
navigation elements (<code>nav</code>) are excluded.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A single string of markdown.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># reticulate::py_available()</span></span></span>
<span class="r-in"><span><span class="co"># Convert HTML</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="st">"https://r4ds.hadley.nz/base-R.html"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="st">"https://r4ds.hadley.nz/base-R.html"</span>, canonical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When converting HTML, you might want to omit certain elements, like</span></span></span>
<span class="r-in"><span><span class="co"># sidebars, headers, footers, etc. You can pass CSS selector strings</span></span></span>
<span class="r-in"><span><span class="co"># to either extract nodes or exclude nodes during conversion.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># The easiest way to make selectors is to use SelectorGadget:</span></span></span>
<span class="r-in"><span><span class="co"># https://rvest.tidyverse.orgarticles/selectorgadget.html</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># You can also right-click on a page and select "Inspect Element" in a</span></span></span>
<span class="r-in"><span><span class="co"># browser to better understand an HTML page's structure.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># For comprehensive or advanced usage of CSS selectors, consult:</span></span></span>
<span class="r-in"><span><span class="co"># https://www.crummy.com/software/BeautifulSoup/bs4/doc/#css-selectors-through-the-css-property</span></span></span>
<span class="r-in"><span><span class="co"># https://facelessuser.github.io/soupsieve/selectors/</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://duckdb.org/code_of_conduct"</span></span></span>
<span class="r-in"><span><span class="co"># Includes the sidebar and other navigational elements</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the main content</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="va">url</span>, html_extract_selectors <span class="op">=</span> <span class="st">"#main_content_wrap"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative approach: exclude nodes</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">url</span>,</span></span>
<span class="r-in"><span>  html_zap_selectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"header"</span>,          <span class="co"># node name</span></span></span>
<span class="r-in"><span>    <span class="st">".sidenavigation"</span>, <span class="co"># node class</span></span></span>
<span class="r-in"><span>    <span class="st">".searchoverlay"</span>,  <span class="co"># node class</span></span></span>
<span class="r-in"><span>    <span class="st">"#sidebar"</span>         <span class="co"># node ID</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quarto example</span></span></span>
<span class="r-in"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://quarto.org/docs/computations/python.html"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Include sidebar, footer, etc.</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">url</span>,</span></span>
<span class="r-in"><span>  html_extract_selectors <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  html_zap_selectors <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exclude content outside &lt;main&gt;</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="va">url</span>, html_extract_selectors <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exclude specific matching nodes</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">url</span>,</span></span>
<span class="r-in"><span>  html_extract_selectors <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  html_zap_selectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"#quarto-sidebar"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"#quarto-margin-sidebar"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"header"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"footer"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"nav"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert PDF</span></span></span>
<span class="r-in"><span><span class="va">pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Rhome.html" class="external-link">R.home</a></span><span class="op">(</span><span class="st">"doc"</span><span class="op">)</span>, <span class="st">"NEWS.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">read_as_markdown</span><span class="op">(</span><span class="va">pdf</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Alternative:</span></span></span>
<span class="r-in"><span><span class="co"># pdftools::pdf_text(pdf) |&gt; substr(1, 2000) |&gt; cat()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert images to markdown descriptions using OpenAI</span></span></span>
<span class="r-in"><span><span class="va">jpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Rhome.html" class="external-link">R.home</a></span><span class="op">(</span><span class="st">"doc"</span><span class="op">)</span>, <span class="st">"html"</span>, <span class="st">"logo.jpg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"OPENAI_API_KEY"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># if (xfun::is_macos()) system("brew install ffmpeg")</span></span></span>
<span class="r-in"><span>  <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_require.html" class="external-link">py_require</a></span><span class="op">(</span><span class="st">"openai"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">llm_client</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"openai"</span><span class="op">)</span><span class="op">$</span><span class="fu">OpenAI</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">read_as_markdown</span><span class="op">(</span><span class="va">jpg</span>, llm_client <span class="op">=</span> <span class="va">llm_client</span>, llm_model <span class="op">=</span> <span class="st">"gpt-4.1-mini"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># # Description:</span></span></span>
<span class="r-in"><span>  <span class="co"># The image displays the logo of the R programming language. It features a</span></span></span>
<span class="r-in"><span>  <span class="co"># large, stylized capital letter "R" in blue, positioned prominently in the</span></span></span>
<span class="r-in"><span>  <span class="co"># center. Surrounding the "R" is a gray oval shape that is open on the right</span></span></span>
<span class="r-in"><span>  <span class="co"># side, creating a dynamic and modern appearance. The R logo is commonly</span></span></span>
<span class="r-in"><span>  <span class="co"># associated with statistical computing, data analysis, and graphical</span></span></span>
<span class="r-in"><span>  <span class="co"># representation in various scientific and professional fields.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative approach to image conversion:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"OPENAI_API_KEY"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">is_installed</a></span><span class="op">(</span><span class="st">"ellmer"</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">is_installed</a></span><span class="op">(</span><span class="st">"magick"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/chat_openai.html" class="external-link">chat_openai</a></span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"Describe this image"</span>, <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/content_image_url.html" class="external-link">content_image_file</a></span><span class="op">(</span><span class="va">jpg</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, Daniel Falbel, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

